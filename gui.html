<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8 from src/site/apt/gui.apt
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MicroCol &#x2013; GUI</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>MicroCol</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">MicroCol</li>
    <li><a href="index.html" title="Index"><span class="none"></span>Index</a></li>
    <li><a href="manifest.html" title="Manifest"><span class="none"></span>Manifest</a></li>
    <li><a href="rules.html" title="Rules"><span class="none"></span>Rules</a></li>
    <li><a href="change-log.html" title="Change log"><span class="none"></span>Change log</a></li>
      <li class="nav-header">Development</li>
    <li><a href="development.html" title="Development"><span class="none"></span>Development</a></li>
    <li><a href="todo.html" title="ToDo"><span class="none"></span>ToDo</a></li>
    <li><a href="release.html" title="Release"><span class="none"></span>Release</a></li>
    <li class="active"><a href="#"><span class="none"></span>GUI</a></li>
    <li><a href="animation.html" title="Animation"><span class="none"></span>Animation</a></li>
    <li><a href="coding.html" title="Coding"><span class="none"></span>Coding</a></li>
    <li><a href="tests.html" title="Tests"><span class="none"></span>Tests</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<div class="section">
<h2><a name="GUI_-_structure_and_behavior"></a>GUI - structure and behavior</h2>
<p>Here is described class composition of game GUI and it's behavior.</p>
<div class="section">
<h3><a name="GUI_structure"></a>GUI structure</h3>
<p>For most of panels is used <a class="externalLink" href="https://en.wikipedia.org/wiki/Model–view–presenter">Model view presenter</a> (MVP). It's described at <a class="externalLink" href="http://www.g-widgets.com/2016/01/19/introduction-to-the-mvp-pattern-in-gwt/">http://www.g-widgets.com/2016/01/19/introduction-to-the-mvp-pattern-in-gwt/</a>.</p>
<div class="section">
<h4><a name="Class_MainStageBuilder"></a>Class MainStageBuilder</h4>
<p>After game start GUI is builded in class <i>org.microcol.gui.MainStageBuilder</i>. In this class are composed classes and <i>org.microcol.gui.mainmenu.MainMenuView</i> and <i>org.microcol.gui.MainPanelView</i>in on view. On screen it look like: </p>
<div>
<pre> +--------------------------------------------+
 |               MainMenuView                 |
 +--------------------------------------------+
 |                                            |
 |                                            |
 |                                            |
 |               MainPanelView                |
 |                                            |
 |                                            |
 |                                            |
 |                                            |
 |                                            |
 |                                            |
 |                                            |
 |                                            |
 +--------------------------------------------+</pre></div></div>
<div class="section">
<h4><a name="Class_MainPanelView"></a>Class MainPanelView</h4>
<p>This class hold whole game. Design pattern in used for this view is MVP. So there is also class MainPanelPresenter. Class <i>MainPanelView</i> mainly it switch between three views. </p>
<ul>
<li>MainGamePanelView - Contains played game. It's described in next chapter. Game itself is inside this frame. MainPanel have following structure:
<div>
<pre> +---------------------------------+----------+
 |                                 |          |
 |                                 |          |
 |                                 |          |
 |          GamePanel              | RighPanel|
 |                                 |          |
 |                                 |          |
 |                                 |          |
 |                                 |          |
 |                                 |          |
 |                                 |          |
 +---------------------------------+----------+</pre></div>
<p>Game panel contains game.</p></li>
<li>GameMenuPanelView - Shows list of basic options. 
<p>Start panel just show simple options like &quot;start new game&quot; and &quot;close application&quot;. It look like:</p><img src="start-application.png" alt="Application start." /></li>
<li>CampaignPanelView - contains menu with default campaign.
<p>It show missions and allows user select mission to play. </p><img src="start-application-mission.png" alt="Campaign menu " /></li></ul></div></div>
<div class="section">
<h3><a name="GUI_behavior"></a>GUI behavior</h3>
<p>Diagram describes main screen flow when game starts. There are some additional behavior rules:</p>
<ul>
<li>When user finish one mission next one is automatically started.</li>
<li>When last mission is finished than game menu is shown.</li>
<li>When user choose &quot;Exit Game&quot; from main menu than game menu is shown.</li></ul>
<p>Screen flow is depicted here:</p><img src="main-screen-flow.png" alt="MicroCol screen flow" />
<div class="section">
<h4><a name="Game_Menu_panel"></a>Game Menu panel</h4>
<p>When user look at game menu just some buttons are enabled. It controlled in a following way:</p><img src="main-menu.png" alt="Game menu button enabling logic." /></div>
<div class="section">
<h4><a name="Game_loading"></a>Game loading</h4>
<p>Suppose that use choose some campaign from campaign menu.</p><img src="game-starting.png" alt="Loading of campaign." /></div>
<div class="section">
<h4><a name="Unit_and_tile_selecting_events"></a>Unit and tile selecting events</h4>
<p>There are events:</p>
<ul>
<li>TileWasSelectedEvent - Is fired when new tile is selected by <i>SelectedTileManager</i>. Event hold information if screen should smoothly scroll at selected tile or screen should jump at selected tile or do nothing. </li>
<li>UnitWasSelectedEvent - Holds info about selected tile and selected unit. Is fired by <i>SelectedUnitManager</i>. Hold reference to selected unit. Event is fired event when unit is deselected. For example player focus location without any units. </li></ul>
<p>This event are raised in following scenarios in following order:</p>
<ul>
<li>User click at unit. - When user click than tile should be selected. If there are some unit that could move than first such unit is selected. So called events are: 
<ol style="list-style-type: decimal">
<li>TileWasSelectedEvent - tile is selected but screen don't center at this tile.</li>
<li>UnitWasSelectedEvent - just when there is selected unit</li></ol></li>
<li>User click at unit with key modifier e.g. &#8984;. - Same as previous case but when tile is selected than screen scroll to put selected tile to the center.</li>
<li>User choose specific unit from unit at already selected tile - Just event UnitWasSelectedEvent is raised.</li>
<li>Focused unit is moved to city field. - Class <i>SelectedUnitManager</i> should be called and it fire event UnitWasSelectedEvent. When there is another unit that could be selected than this unit is selected otherwise selected unit is set to <i>null</i>.</li>
<li>Focused unit is destroyed. - Tile stay selected but UnitWasSelectedEvent is raised with selected unit set to <i>null</i>.</li></ul>
<div>
<pre>

        Unsorted mess follows.

</pre></div></div>
<div class="section">
<h4><a name="Campaign"></a>Campaign</h4><img src="campaign.png" alt="Campaign" />
<p>Mission will register it's own <i>ModelListener</i> to be notify about all important events. It allows to show success message like &quot;You did it&quot;. </p></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">

        </div>
      </div>
    </footer>
  </body>
</html>
