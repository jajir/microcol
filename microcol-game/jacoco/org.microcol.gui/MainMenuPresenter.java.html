<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MainMenuPresenter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MicroCol game classes</a> &gt; <a href="index.source.html" class="el_package">org.microcol.gui</a> &gt; <span class="el_source">MainMenuPresenter.java</span></div><h1>MainMenuPresenter.java</h1><pre class="source lang-java linenums">package org.microcol.gui;

import javax.swing.JCheckBoxMenuItem;
import javax.swing.JMenuItem;
import javax.swing.JRadioButtonMenuItem;

import org.microcol.gui.event.ChangeLanguageController;
import org.microcol.gui.event.FocusedTileController;
import org.microcol.gui.event.FocusedTileEvent;
import org.microcol.gui.event.GameEventController;
import org.microcol.gui.event.MoveUnitController;
import org.microcol.gui.event.ShowGridController;
import org.microcol.gui.event.TurnStartedController;
import org.microcol.gui.event.ViewController;
import org.microcol.gui.event.VolumeChangeController;
import org.microcol.model.event.TurnStartedEvent;

import com.google.common.base.Preconditions;
import com.google.inject.Inject;

public class MainMenuPresenter {

	public interface Display {
		JMenuItem getMenuItemNewGame();

		JMenuItem getMenuItemLoadGame();

		JMenuItem getMenuItemSameGame();

		JMenuItem getMenuItemQuitGame();

		JMenuItem getMenuItemAbout();

		JRadioButtonMenuItem getRbMenuItemlanguageEn();

		JRadioButtonMenuItem getRbMenuItemlanguageCz();

		void updateLanguage();

		JMenuItem getMenuItemVolume();

		JCheckBoxMenuItem getMenuItemShowGrid();

		JMenuItem getMenuItemMove();

		JMenuItem getMenuItemCenterView();
	}

	private final MainMenuPresenter.Display display;

<span class="nc" id="L51">	private boolean isFocusedMoveableUnit = false;</span>

<span class="nc" id="L53">	public boolean isTileFocused = false;</span>

	@Inject
	public MainMenuPresenter(final MainMenuPresenter.Display display, final GameEventController gameEventController,
			final GamePreferences gamePreferences, final ChangeLanguageController languangeController, final Text text,
			final ViewUtil viewUtil, final VolumeChangeController volumeChangeController,
			final ShowGridController showGridController, final FocusedTileController focusedTileController,
			final MoveUnitController moveUnitController, final ViewController viewController,
<span class="nc" id="L61">			final TurnStartedController turnStartedController) {</span>
<span class="nc" id="L62">		this.display = Preconditions.checkNotNull(display);</span>
<span class="nc" id="L63">		display.getMenuItemNewGame().addActionListener(actionEvent -&gt; {</span>

<span class="nc" id="L65">		});</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">		if (!gamePreferences.isOSX()) {</span>
<span class="nc" id="L67">			display.getMenuItemQuitGame().addActionListener(actionEvent -&gt; {</span>
<span class="nc" id="L68">				gameEventController.fireGameExit();</span>
<span class="nc" id="L69">			});</span>
<span class="nc" id="L70">			display.getMenuItemAbout().addActionListener(actionEvent -&gt; {</span>
<span class="nc" id="L71">				gameEventController.fireAboutGameEvent();</span>
<span class="nc" id="L72">			});</span>
		}
<span class="nc" id="L74">		display.getRbMenuItemlanguageCz().addActionListener(actionEvent -&gt; {</span>
<span class="nc" id="L75">			languangeController.fireLanguageWasChangedEvent(Text.Language.cz);</span>
<span class="nc" id="L76">		});</span>
<span class="nc" id="L77">		display.getRbMenuItemlanguageEn().addActionListener(actionEvent -&gt; {</span>
<span class="nc" id="L78">			languangeController.fireLanguageWasChangedEvent(Text.Language.en);</span>
<span class="nc" id="L79">		});</span>
<span class="nc" id="L80">		display.getMenuItemVolume().addActionListener(actionEvent -&gt; {</span>
<span class="nc" id="L81">			PreferencesVolume preferencesVolume = new PreferencesVolume(viewUtil, text, volumeChangeController,</span>
<span class="nc" id="L82">					gamePreferences.getVolume());</span>
<span class="nc" id="L83">			preferencesVolume.setVisible(true);</span>
<span class="nc" id="L84">		});</span>
<span class="nc" id="L85">		display.getMenuItemShowGrid().addActionListener(</span>
<span class="nc" id="L86">				ectionEvent -&gt; showGridController.fireShowGridEvent(display.getMenuItemShowGrid().isSelected()));</span>
<span class="nc" id="L87">		display.getMenuItemMove().addActionListener(ectionEvent -&gt; {</span>
<span class="nc" id="L88">			moveUnitController.fireStartMoveEvent();</span>
<span class="nc" id="L89">			display.getMenuItemMove().setEnabled(false);</span>
<span class="nc" id="L90">		});</span>
<span class="nc" id="L91">		display.getMenuItemCenterView().addActionListener(event -&gt; viewController.fireCenterView());</span>
<span class="nc" id="L92">		languangeController.addLanguageListener(event -&gt; {</span>
<span class="nc" id="L93">			display.updateLanguage();</span>
<span class="nc" id="L94">		});</span>
<span class="nc" id="L95">		focusedTileController.addFocusedTileListener(event -&gt; onFocusedTileEvent(event));</span>
<span class="nc" id="L96">		turnStartedController.addTurnStartedListener(event -&gt; onTurnStartedEvent(event));</span>
<span class="nc" id="L97">	}</span>

	/**
	 * Method process event when user put focus to some tile.
	 * 
	 * @param event
	 *            required event
	 */
	private final void onFocusedTileEvent(final FocusedTileEvent event) {
<span class="nc" id="L106">		display.getMenuItemCenterView().setEnabled(true);</span>
<span class="nc" id="L107">		isTileFocused = true;</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">		if (event.isTileContainsMovebleUnit()) {</span>
<span class="nc" id="L109">			display.getMenuItemMove().setEnabled(true);</span>
<span class="nc" id="L110">			isFocusedMoveableUnit = true;</span>
		} else {
<span class="nc" id="L112">			display.getMenuItemMove().setEnabled(false);</span>
<span class="nc" id="L113">			isFocusedMoveableUnit = false;</span>
		}
<span class="nc" id="L115">	}</span>

	private final void onTurnStartedEvent(final TurnStartedEvent event) {
<span class="nc bnc" id="L118" title="All 2 branches missed.">		if (event.getPlayer().isHuman()) {</span>
<span class="nc bnc" id="L119" title="All 2 branches missed.">			if (isTileFocused) {</span>
<span class="nc" id="L120">				display.getMenuItemCenterView().setEnabled(true);</span>
			}
<span class="nc bnc" id="L122" title="All 2 branches missed.">			if (isFocusedMoveableUnit) {</span>
<span class="nc" id="L123">				display.getMenuItemMove().setEnabled(true);</span>
			}
		} else {
<span class="nc" id="L126">			display.getMenuItemCenterView().setEnabled(false);</span>
<span class="nc" id="L127">			display.getMenuItemMove().setEnabled(false);</span>
		}
<span class="nc" id="L129">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>